Realizamos un escaneo de nmap y encontramos los siguientes puertos abiertos
![[Pasted image 20240607084450.png]]
![[Pasted image 20240607084548.png]]

Realizamos un escaneo url con dirb
![[Pasted image 20240607092547.png]]

Una vez realizamos el escaneo de los directorios ocultos revisamos las webs y encontramos una foto que contiene metadatos
![[Pasted image 20240607085434.png]]

Nos la descargamos
![[Pasted image 20240607085854.png]]

Y ahora la analizamos con exiftool
![[Pasted image 20240607090229.png]]

Encontramos un titulo, accedemos a el desde el navegador y encontramos unas credenciales
![[Pasted image 20240607090338.png]]


Accedemos al puerto 3000 y estamos en el servicio
![[Pasted image 20240607090518.png]]

Accedemos al panel de login y nos logueamos, y como podemos ver ya hemos accedido al panel
![[Pasted image 20240607090621.png]]

Buscando encontramos la primera flag
![[Pasted image 20240607090754.png]]

En la información donde se ubicaba las credenciales aparecia otra ubicación, accedemos a ella
![[Pasted image 20240607091131.png]]

En esta ubicacion encontramos el boton de ejecución del panel que ejcuta el siguiente fichero .yaml asi que vamos a modificarlo y a generar una reverse shell
![[Pasted image 20240607091507.png]]

Nos ponemos en escucha con netcat y ejecutamos el boton de Run Ansible Playbook y obtenemos la reverse shell
![[Pasted image 20240607091655.png]]

Generamos una shell estable y obtenemos la segunda flag
![[Pasted image 20240607091858.png]]

Ahora realizaremos una escalada de privilegios para ello utilizaremos una herramienta para la busqueda de vulnerabilidades llamada LinPEAS, para ello primero la descargamos en nuestra maquina
```
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
```
![[Pasted image 20240607100351.png]]

Cargamos un servidor de python para subir el binario
![[Pasted image 20240607100434.png]]

Y nos lo descargamos en la maquina victima
![[Pasted image 20240607100803.png]]

Agregamos los permisos de ejecución
![[Pasted image 20240607100948.png]]

Y ejecutamos el binario en la maquina victima y ya comenzara a buscar las posibles vulnerabilidades
![[Pasted image 20240607101037.png]]

Después de analizarlo encontramos la siguiente vulnerabilidad que nos permite realizar una escalda de privilegios
```
https://github.com/blasty/CVE-2021-3156
```

Nos descargamos el repositorio y lo comprimimos
```Bash
sudo tar -cvf CVE-2021-3156.tar CVE-2021-3156
```

Una vez comprimido creamos un servidor para enviarlo a la maquina victima
![[Pasted image 20240611120838.png]]

Lo descargamos y lo descomprimimos
![[Pasted image 20240611120928.png]]

Una vez descomprimido accedemos a la carpeta y ejecutamos los siguientes comandos y ya habremos obtenido los permisos de root
```
make
./sudo-hax-me-a-sandwich
./sudo-hax-me-a-sandwich 1
```
![[Pasted image 20240611121058.png]]


